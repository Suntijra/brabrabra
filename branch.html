<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width" />
    <title>สาขาร้านค้า</title>
    <!-- font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prompt&display=swap" rel="stylesheet">
    <!-- css -->
    <link rel="stylesheet" type="text/css" href="./globle_newmerchant.css" />
    <link rel="stylesheet" type="text/css" href="./slick-1.8.1/slick/slick.css" />
    <link rel="stylesheet" type="text/css" href="./slick-1.8.1/slick/slick-theme.css" />

    <!-- script -->
    <script src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>

    <script type="text/javascript" src="./slick-1.8.1/slick/slick.min.js"></script>
    <link href="http://fonts.cdnfonts.com/css/gilroy-bold" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
        integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Prompt:ital,wght@0,100;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <!-- Axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>


    <style>
        .font_Prompt {
            font-family: 'Prompt', sans-serif;
        }
    </style>


</head>


<body>

    <!-- TONY 29 june 2022 11:55 started  -->
    <div class="BNMain container BG1">

        <div class="BNTop">

            <div class="backBtnContainer">
                <div class="back_button ">
                    <i class="fas fa-arrow-left"></i>
                </div>

                <img class="BNHomeBtnImg" src="imgs/home.png" alt="home">
            </div>

            <div class="BNATextTopBox">
                <div class="BNTopText h1 font_Prompt BB">
                    สาขาร้านค้า
                </div>
            </div>





        </div>


        <div id="frontdata" style="overflow: scroll;" class="BNBody">
            <!-- <div class="BNInfoContainer shadow-test">
                <div class="BNInfoTop">
                    <img src="imgs/shop-icon.png" alt="shop-icon" class="BNInfoShopIcon">
                    <div class="BNInfoTopTextBox">
                        <div class="BNInfoText1 h1 font_Prompt BB primary-text-black">เลิฟมีเทนเดอร์</div>
                        <div class="BNInfoText2 h3 font_Prompt BB primary-text-bitterweet">สำนักงานใหญ่</div>
                    </div>
                </div>
                <div class="BNInfoBot">

                    <div class="BNInfoTextbox">
                        <div class="BNInfoText3 font_Prompt h3">
                            ดูข้อมูลสาขานี้
                        </div>
                        <i class="fa-solid fa-chevron-right"></i>
                    </div>


                    <div class="onoffswitch">
                        <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch"
                            tabindex="0" checked>
                        <label class="onoffswitch-label" for="myonoffswitch">
                            <span class="onoffswitch-inner"></span>
                            <span class="onoffswitch-switch"></span>
                        </label>
                    </div>

                </div>
            </div>



            <div class="BNInfoContainer shadow-test">
                <div class="BNInfoTop">
                    <img src="imgs/shop-icon.png" alt="shop-icon" class="BNInfoShopIcon">
                    <div class="BNInfoTopTextBox">
                        <div class="BNInfoText1 h1 font_Prompt BB primary-text-black">เลิฟมีเทนเดอร์</div>
                        <div class="BNInfoText2 h3 font_Prompt BB primary-text-bitterweet">สาขา 0001</div>

                    </div>

                </div>

                <div class="BNInfoBot">

                    <div class="BNInfoTextbox">
                        <div class="BNInfoText3 font_Prompt h3">
                            ดูข้อมูลสาขานี้
                        </div>
                        <i class="fa-solid fa-chevron-right"></i>
                    </div>


                    <div class="onoffswitch">
                        <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch1"
                            tabindex="0" checked>
                        <label class="onoffswitch-label" for="myonoffswitch1">
                            <span class="onoffswitch-inner"></span>
                            <span class="onoffswitch-switch"></span>
                        </label>
                    </div>

                </div>

            </div> -->


        </div>



        <div class="BNFooter">
            <div class="salmonlong_button h3 font_Prompt shadow-test">
                <p class="font_Prompt primary-text-white BB">+ เพิ่มสาขาร้านค้า</p>
            </div>
        </div>

    </div>


</body>

</html>
<script>
    console.log(1)
    // axios.post('http://192.168.1.18:3000/api/Shopsakainfo',(resp)=>{
    //     console.log('++++++++++++++++++++++++++')
    //     console.log(resp);
    // })
    var datalengeh = 0;
    var datacusID = []
    $.ajax({
        method: 'post',
        url: 'http://192.168.1.18:3000/api/merchant/Shopsakainfo',
        success: (response) => {
            data = response.data
            datalengeh = data[0].length
            if (response.status == 'ok') {
                console.log(data[0].length)
                var htmlInner = '';
                for (let i = 0; i < data[0].length; i++) {
                    datacusID.push(data[0][i].customerID)
                    htmlInner += `<div class="BNInfoContainer shadow-test">
                <div class="BNInfoTop">
                    <img src="imgs/shop-icon.png" alt="shop-icon" class="BNInfoShopIcon">
                    <div class="BNInfoTopTextBox">
                        <div class="BNInfoText1 h1 font_Prompt BB primary-text-black">${data[0][i].shopName}</div>
                        <div class="BNInfoText2 h3 font_Prompt BB primary-text-bitterweet">${data[0][i].branch}</div>
                    </div>
                </div>
                <div class="BNInfoBot">

                    <div class="BNInfoTextbox">
                        <div id = "${data[0][i].customerID}" onclick="showinfo(this)" class="BNInfoText3 font_Prompt h3">
                            ดูข้อมูลสาขานี้
                        </div>
                        <i class="fa-solid fa-chevron-right"></i>
                    </div>
                    <div class="onoffswitch">
                        <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="${i}myonoffswitch" onchange="switchChange(this.id,${data[0][i].customerID});"
                            tabindex="0" checked>
                        <label class="onoffswitch-label" for="${i}myonoffswitch">
                            <span class="onoffswitch-inner"></span>
                            <span class="onoffswitch-switch"></span>
                        </label>
                    </div>

                </div>
            </div>`
                }
                document.getElementById("frontdata").innerHTML = htmlInner
                for (let i = 0; i < data[0].length; i++) {
                    if (data[0][i].status == 'open') {
                        document.getElementById(i + 'myonoffswitch').checked = true
                    } else {
                        document.getElementById(i + 'myonoffswitch').checked = false
                    }
                }

            } else {
                console.log('ติดต่อหลังบ้านไม่ได้')
            }
        },
        error: function (err) {
            console.log(err)
        }
    })
    
    // for(let i = 0 ;i<datalengeh;i++){
    //     document.getElementById(i+'myonoffswitch').addEventListener('change',switchChange(i+'myonoffswitch',datacusID[i]))
    // }


    function switchChange(eid,cusID) {
        console.log(eid)
        let dataForUpdate = {
            customerID: '',
            status: ''
        }
        let status = document.getElementById(eid).checked
        console.log(status)
        if (status == true) {
            console.log("111")
            dataForUpdate.customerID = cusID
            dataForUpdate.status = 'open'
        } else {
            console.log("222")
            dataForUpdate.customerID = cusID
            dataForUpdate.status = 'close'
        }
        axios.post("http://192.168.1.18:3000/api/merchant/branch/update/status",{
            data : dataForUpdate
        }).then((result) => {
            console.log(result)
            console.log(updated)
        }).catch((err) => {
            console.log(err)
        });

    }
    function showinfo(e) {
        window.location.href = "./BN_info.html?id=" + e.id
    }
    // window.location.href = "./BN_info.html/product=shirt&color=blue&newuser&size=m"
</script>